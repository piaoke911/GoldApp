name: Gold-Quantum-Final-Success
on: [push, workflow_dispatch]

jobs:
  build:
    runs-on: ubuntu-22.04
    steps:
      - name: ğŸš€ 1. æºç åŒæ­¥
        uses: actions/checkout@v4

      - name: ğŸ—ï¸ 2. ç¯å¢ƒå¼ºåˆ¶åˆå§‹åŒ– (å…¨èƒ½å·¥å…·åŒ…)
        run: |
          sudo apt update
          sudo apt install -y \
            python3-pip python3-setuptools git zip unzip \
            openjdk-17-jdk autoconf libtool pkg-config zlib1g-dev \
            libncurses5-dev libncursesw5-dev libtinfo5 cmake libltdl-dev \
            libffi-dev libssl-dev
          
          # å¼ºåˆ¶å®‰è£…å›ºå®šç‰ˆæœ¬çš„ç¼–è¯‘å·¥å…·
          pip3 install --user --upgrade buildozer Cython==0.29.36 virtualenv
          # æŠŠè¿è¡Œè·¯å¾„åŠ å…¥ç³»ç»Ÿç¯å¢ƒ
          echo "/home/runner/.local/bin" >> $GITHUB_PATH

      - name: ğŸ§  3. å¼ºåˆ¶æƒé™è§£é” & å¯åŠ¨ç¼–è¯‘
        # è¿™é‡Œæ˜¯çµé­‚ï¼šyes | ... ä¼šè‡ªåŠ¨å¸®ä½ åœ¨åå°â€œç‚¹åŒæ„â€æ‰€æœ‰å®‰å“åè®®
        run: |
          export PATH=$PATH:~/.local/bin
          yes | buildozer android debug
        env:
          APP_ANDROID_ACCEPT_SDK_LICENSE: "1"
          BUILDOZER_USE_SUDO: "0"

      - name: ğŸ“¦ 4. æˆæœæå–
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: GoldApp-Final-APK
          path: bin/*.apk
